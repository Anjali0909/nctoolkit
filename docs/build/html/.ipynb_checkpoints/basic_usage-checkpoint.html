
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="python">
  <head>
    <meta charset="utf-8" />
    <title>Introduction tutorial &#8212; nchack 0.1 documentation</title>
    <link rel="stylesheet" href="../_static/nature.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/language_data.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="nav-item nav-item-0"><a href="../index.html">nchack 0.1 documentation</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput,
div.nbinput div.prompt,
div.nbinput div.input_area,
div.nbinput div[class*=highlight],
div.nbinput div[class*=highlight] pre,
div.nboutput,
div.nbinput div.prompt,
div.nbinput div.output_area,
div.nboutput div[class*=highlight],
div.nboutput div[class*=highlight] pre {
    background: none;
    border: none;
    padding: 0 0;
    margin: 0;
    box-shadow: none;
}

/* avoid gaps between output lines */
div.nboutput div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput,
div.nboutput {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput,
    div.nboutput {
        flex-direction: column;
    }
}

/* input container */
div.nbinput {
    padding-top: 5px;
}

/* last container */
div.nblast {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput div.prompt,
div.nboutput div.prompt {
    min-width: 5ex;
    padding-top: 0.4em;
    padding-right: 0.4em;
    text-align: right;
    flex: 0;
}
@media (max-width: 540px) {
    div.nbinput div.prompt,
    div.nboutput div.prompt {
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput div.prompt.empty {
        padding: 0;
    }
}

/* disable scrollbars on prompts */
div.nbinput div.prompt pre,
div.nboutput div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput div.input_area,
div.nboutput div.output_area {
    padding: 0.4em;
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput div.input_area,
    div.nboutput div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    background: #f5f5f5;
}

/* override MathJax center alignment in output cells */
div.nboutput div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput div.math p {
    text-align: left;
}

/* standard error */
div.nboutput div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}
</style>
<div class="section" id="Introduction-tutorial">
<h1>Introduction tutorial<a class="headerlink" href="#Introduction-tutorial" title="Permalink to this headline">¶</a></h1>
<div class="section" id="Introducing-trackers">
<h2>Introducing trackers<a class="headerlink" href="#Introducing-trackers" title="Permalink to this headline">¶</a></h2>
<p>The fundamental object of analysis in this package is a tracker. The tracker is initialized with a single netcdf file or an ensemble of files, and will keep track of any manipulations carried. Behind the scenes most of the manipulations are done using CDO or NCO. The tracker will keep track of all CDO/NCO commands used. However, unless you are experienced with CDO or NCO you can ignore all of this.</p>
</div>
<div class="section" id="Initializing-a-tracker">
<h2>Initializing a tracker<a class="headerlink" href="#Initializing-a-tracker" title="Permalink to this headline">¶</a></h2>
<p>I will illustrate the basic usage using a climatology of global sea surface temperature from NOAA. We can download this using wget as follow.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">IPython.display</span> <span class="k">import</span> <span class="n">clear_output</span>
<span class="o">!</span> wget ftp://ftp.cdc.noaa.gov/Datasets/COBE2/sst.mon.ltm.1981-2010.nc
<span class="n">clear_output</span><span class="p">()</span>
</pre></div>
</div>
</div>
<p>The first step in any analysis will be to import nchack, which I will call nc as shorthand. Please note I am suppressing warnings to make this notebook more readable. I do not recommend suppressing warnings….</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">nchack</span> <span class="k">as</span> <span class="nn">nc</span>
<span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Tip: include atexit.register(nchack.clean_all) after loading nchack
</pre></div></div>
</div>
<p>Under the hood nchack will generate temporary netcdf files. The package is designed to remove temp files that are no longer in use, and will automatically clean up any temporary files generated when Python closes. However, this is not 100% guaranteed to work during system crashes etc.</p>
<p>It is therefore recommended to do a deep_clean at the start of any session to remove any leftover netcdf files that might have existed in a previous sessions. Obviously, do not run this if you have multiple instances of nchack running simultaneously.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">nc</span><span class="o">.</span><span class="n">deep_clean</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="Creating-a-tracker">
<h2>Creating a tracker<a class="headerlink" href="#Creating-a-tracker" title="Permalink to this headline">¶</a></h2>
<p>We can then set up the tracker file which we will use for manipulating the SST climatology.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">ff</span> <span class="o">=</span>  <span class="s2">&quot;sst.mon.ltm.1981-2010.nc&quot;</span>
<span class="n">tracker</span> <span class="o">=</span> <span class="n">nc</span><span class="o">.</span><span class="n">NCTracker</span><span class="p">(</span><span class="n">ff</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="Accessing-tracker-attributes">
<h2>Accessing tracker attributes<a class="headerlink" href="#Accessing-tracker-attributes" title="Permalink to this headline">¶</a></h2>
<p>At this point there is very little useful information in the tracker. Essentially, all it tell us is the start file. This will always remain the same.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">tracker</span><span class="o">.</span><span class="n">start</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>&#39;sst.mon.ltm.1981-2010.nc&#39;
</pre></div>
</div>
</div>
<p>The current state of the tracker can be found as follows.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">tracker</span><span class="o">.</span><span class="n">current</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>&#39;sst.mon.ltm.1981-2010.nc&#39;
</pre></div>
</div>
</div>
<p>We tracker history as follows, which is initially empty.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">tracker</span><span class="o">.</span><span class="n">history</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>[]
</pre></div>
</div>
</div>
<p>A simple, but important first task when analyzing netcdf data is knowing the variables in the file. We can do this quickly by accessing the variables attribute</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">tracker</span><span class="o">.</span><span class="n">variables</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>[&#39;sst&#39;, &#39;valid_yr_count&#39;]
</pre></div>
</div>
</div>
<p>Often, we will want to know the size of a tracker. This is most relevant when we are working with multiple files. We can do this by accessing the size attribute. To speed up computations, variables and size are computed lazily.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">tracker</span><span class="o">.</span><span class="n">size</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Number of files: 1
File size: 4.670688 MB
</pre></div></div>
</div>
<p>In this case we can see that the file is 4 MB, and we are also told that there is only one file.</p>
</div>
<div class="section" id="Variable-selection-and-geographic-clipping">
<h2>Variable selection and geographic clipping<a class="headerlink" href="#Variable-selection-and-geographic-clipping" title="Permalink to this headline">¶</a></h2>
<p>We can clip netcdf files in space or time using clip. Let’s say we only cared about temperature in July for the North Atlantic. This be found very easily using the following.</p>
<p>netcdf files often have variables that we are not interested in. We can therefore easily select or delete variables. If we want to select variables we can use the select_variables method, which requires either a single variable or a list of variables. Here I will select sst.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">tracker</span><span class="o">.</span><span class="n">select_variables</span><span class="p">(</span><span class="s2">&quot;sst&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>We can now see that there is only one variable in the tracker</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">tracker</span><span class="o">.</span><span class="n">variables</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>[&#39;sst&#39;]
</pre></div>
</div>
</div>
<p>We can also that a temporary file has been created with only this variable in it</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">tracker</span><span class="o">.</span><span class="n">current</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>&#39;/tmp/nchacknmbkniqznchacknchacknmbkniqznchacktmpca3rp_q4.nc&#39;
</pre></div>
</div>
</div>
<p>If we want to clip the file geographically we can use the clip method. All we need is the longitude and latitude range. So if we wanted to clip the SST data to the North Atlantic we would do the following.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">tracker</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="n">lon</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">80</span><span class="p">,</span> <span class="mi">20</span><span class="p">],</span> <span class="n">lat</span> <span class="o">=</span> <span class="p">[</span><span class="mi">30</span><span class="p">,</span> <span class="mi">80</span><span class="p">])</span>
</pre></div>
</div>
</div>
<p>We have now carried out some manipulations on the tracker. So, the current file has now changed.</p>
<p>Likewise, we now have a history to look at.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">tracker</span><span class="o">.</span><span class="n">history</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>[&#39;cdo -s -selname,sst sst.mon.ltm.1981-2010.nc /tmp/nchacknmbkniqznchacknchacknmbkniqznchacktmpca3rp_q4.nc&#39;,
 &#39;cdo -s -sellonlatbox,-80,20,30,80 /tmp/nchacknmbkniqznchacknchacknmbkniqznchacktmpca3rp_q4.nc /tmp/nchacknmbkniqznchacknchacknmbkniqznchacktmp0ovs1npj.nc&#39;]
</pre></div>
</div>
</div>
<p>This will give us the list of CDO or NCO commands used under the hood. nchack is designed to be usable without any prior knowledge of CDO or NCO.</p>
</div>
<div class="section" id="Importing-a-tracker-in-xarray">
<h2>Importing a tracker in xarray<a class="headerlink" href="#Importing-a-tracker-in-xarray" title="Permalink to this headline">¶</a></h2>
<p>xarray is a powerful netcdf manipulation tool. In fact, in some use cases it will be more computationally efficient than CDO or NCO. nchack has a built in method for reading the tracker’s current state in as an xarrary format, to_xarray.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">tracker</span><span class="o">.</span><span class="n">to_xarray</span><span class="p">()</span><span class="o">.</span><span class="n">sst</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">col</span> <span class="o">=</span> <span class="s2">&quot;time&quot;</span><span class="p">,</span> <span class="n">col_wrap</span> <span class="o">=</span> <span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>&lt;xarray.plot.facetgrid.FacetGrid at 0x7f46400d0f60&gt;
</pre></div>
</div>
</div>
</div>
<div class="section" id="Deleting-an-object">
<h2>Deleting an object<a class="headerlink" href="#Deleting-an-object" title="Permalink to this headline">¶</a></h2>
<p>If we want to delete a tracker we simply use the standard python del approach. nchack has been designed so that it is constantly cleaning up the system using a simple rule: only keep temp files created if they are among the current files of trackers. Right now, we only have one tracker, called “tracker”. So if we delete tracker it will also delete the current temp file from that tracker. We can see this by looking at what happens to the current state of the tracker when we delete. Right now it
exists on the system.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">tracker</span><span class="o">.</span><span class="n">current</span>
<span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>True
</pre></div>
</div>
</div>
<p>But if we delete the tracker, it will disappear.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">del</span> <span class="n">tracker</span>
<span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>False
</pre></div>
</div>
</div>
</div>
<div class="section" id="Viewing-a-tracker-using-ncview">
<h2>Viewing a tracker using ncview<a class="headerlink" href="#Viewing-a-tracker-using-ncview" title="Permalink to this headline">¶</a></h2>
<p>One of the most popular ways to view a netcdf file is the command line tool ncview. nhack therefore has a simple wrapper around this.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">ff</span> <span class="o">=</span>  <span class="s2">&quot;sst.mon.ltm.1981-2010.nc&quot;</span>
<span class="n">tracker</span> <span class="o">=</span> <span class="n">nc</span><span class="o">.</span><span class="n">NCTracker</span><span class="p">(</span><span class="n">ff</span><span class="p">)</span>
<span class="n">tracker</span><span class="o">.</span><span class="n">view</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="Statistical-operations">
<h2>Statistical operations<a class="headerlink" href="#Statistical-operations" title="Permalink to this headline">¶</a></h2>
<p>nchack has a large number of built in statistical operations, largely built around the methods available in CDO.</p>
</div>
<div class="section" id="Time-averaging">
<h2>Time averaging<a class="headerlink" href="#Time-averaging" title="Permalink to this headline">¶</a></h2>
<p>Averaging in time is one of the most common operations required on netcdf data. nchack allows users to calculate long-term time averages, monthly climatologies, seasonal summaries and many other common statistics.</p>
<p>In this case we are analyzing a monthly climatology of SST. However, what we really might be interested in is the annual average. This can be calculated using the simple mean method, which will calculate the mean over all time steps.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>

<span></span><span class="n">ff</span> <span class="o">=</span>  <span class="s2">&quot;sst.mon.ltm.1981-2010.nc&quot;</span>
<span class="n">tracker</span> <span class="o">=</span> <span class="n">nc</span><span class="o">.</span><span class="n">NCTracker</span><span class="p">(</span><span class="n">ff</span><span class="p">)</span>
<span class="n">tracker</span><span class="o">.</span><span class="n">select_variables</span><span class="p">(</span><span class="s2">&quot;sst&quot;</span><span class="p">)</span>
<span class="n">tracker</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="n">tracker</span><span class="o">.</span><span class="n">to_xarray</span><span class="p">()</span><span class="o">.</span><span class="n">sst</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>&lt;matplotlib.collections.QuadMesh at 0x7f464f80bb38&gt;
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/.ipynb_checkpoints_basic_usage-checkpoint_49_1.png" src="../_images/.ipynb_checkpoints_basic_usage-checkpoint_49_1.png" />
</div>
</div>
<p>Instead of the annual mean, we might be interested in the range of temperatures during the year.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">ff</span> <span class="o">=</span>  <span class="s2">&quot;sst.mon.ltm.1981-2010.nc&quot;</span>
<span class="n">tracker</span> <span class="o">=</span> <span class="n">nc</span><span class="o">.</span><span class="n">NCTracker</span><span class="p">(</span><span class="n">ff</span><span class="p">)</span>
<span class="n">tracker</span><span class="o">.</span><span class="n">select_variables</span><span class="p">(</span><span class="s2">&quot;sst&quot;</span><span class="p">)</span>
<span class="n">tracker</span><span class="o">.</span><span class="n">range</span><span class="p">()</span>
<span class="n">tracker</span><span class="o">.</span><span class="n">to_xarray</span><span class="p">()</span><span class="o">.</span><span class="n">sst</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>&lt;matplotlib.collections.QuadMesh at 0x7f464cd4c630&gt;
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/.ipynb_checkpoints_basic_usage-checkpoint_51_1.png" src="../_images/.ipynb_checkpoints_basic_usage-checkpoint_51_1.png" />
</div>
</div>
<p>Other operations, such as maximum, minimum, and standard deviation are available.</p>
</div>
<div class="section" id="Spatial-statistics">
<h2>Spatial statistics<a class="headerlink" href="#Spatial-statistics" title="Permalink to this headline">¶</a></h2>
<p>Let’s move on to some more advanced methods. I will illustrate these using NOAA’s long-term monthly global data set of sea surface temperatures from 1850 to the present day. You can learn more about this data set here: <a class="reference external" href="https://www.esrl.noaa.gov/psd/data/gridded/data.cobe2.html">https://www.esrl.noaa.gov/psd/data/gridded/data.cobe2.html</a>. To download it you can use wget. This file is approximately 500 MB.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[21]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="o">!</span> wget ftp://ftp.cdc.noaa.gov/Datasets/COBE2/sst.mon.mean.nc
<span class="n">clear_output</span><span class="p">()</span>
</pre></div>
</div>
</div>
<p>This is a long-term data set of global sea surface temperature. So, let’s find out what has happened to average global sea surface temperature since 1850. Unsurprising spoiler: it has been going up. Let’s start by setting up the tracker.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[22]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">ff</span> <span class="o">=</span>  <span class="s2">&quot;sst.mon.mean.nc&quot;</span>
<span class="n">tracker</span> <span class="o">=</span> <span class="n">nc</span><span class="o">.</span><span class="n">NCTracker</span><span class="p">(</span><span class="n">ff</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>We now need to calculate the average global SST. We can do this using the spatial_mean method. This will calculate an area weighted mean for each time step.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[23]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">tracker</span><span class="o">.</span><span class="n">spatial_mean</span><span class="p">()</span>
</pre></div>
</div>
</div>
<p>We can now plot the time series of monthly global mean SST since 1850</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[24]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">tracker</span><span class="o">.</span><span class="n">to_xarray</span><span class="p">()</span><span class="o">.</span><span class="n">sst</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[24]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>[&lt;matplotlib.lines.Line2D at 0x7f464cacde10&gt;]
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/.ipynb_checkpoints_basic_usage-checkpoint_61_1.png" src="../_images/.ipynb_checkpoints_basic_usage-checkpoint_61_1.png" />
</div>
</div>
<p>Our time series shows that, as expected SST increased during the 20th Century. However, this figure has too much noise. We do not care about month to month variations.Instead, let’s look at the rolling 20 year mean. To do this, we will need to first calculate an annual mean then calculated the rolling mean using a window of 20 years. Alternatively, we can just calculate a rolling mean on the initial data using a rolling mean of 20*12 = 240 months.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[25]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">ff</span> <span class="o">=</span>  <span class="s2">&quot;sst.mon.mean.nc&quot;</span>
<span class="n">tracker</span> <span class="o">=</span> <span class="n">nc</span><span class="o">.</span><span class="n">NCTracker</span><span class="p">(</span><span class="n">ff</span><span class="p">)</span>
<span class="n">tracker</span><span class="o">.</span><span class="n">spatial_mean</span><span class="p">()</span>
</pre></div>
</div>
</div>
<p>To calculate the annual mean we can simply use the yearly_mean method.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[26]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">tracker</span><span class="o">.</span><span class="n">yearly_mean</span><span class="p">()</span>
</pre></div>
</div>
</div>
<p>To calculate the rolling mean, we can use rolling_mean, with window set to 20.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[27]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">tracker</span><span class="o">.</span><span class="n">rolling_mean</span><span class="p">(</span><span class="n">window</span> <span class="o">=</span> <span class="mi">20</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[28]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">tracker</span><span class="o">.</span><span class="n">to_xarray</span><span class="p">()</span><span class="o">.</span><span class="n">sst</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[28]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>[&lt;matplotlib.lines.Line2D at 0x7f464c26e748&gt;]
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/.ipynb_checkpoints_basic_usage-checkpoint_68_1.png" src="../_images/.ipynb_checkpoints_basic_usage-checkpoint_68_1.png" />
</div>
</div>
<p>This looks much cleaner. Please note that at present nchack does not adjust the time outputs from CDO. So in this case the rolling mean is centred in the middle of the 20 year period. As nchack evolves more windowing options will be provided to users.</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../index.html">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Introduction tutorial</a><ul>
<li><a class="reference internal" href="#Introducing-trackers">Introducing trackers</a></li>
<li><a class="reference internal" href="#Initializing-a-tracker">Initializing a tracker</a></li>
<li><a class="reference internal" href="#Creating-a-tracker">Creating a tracker</a></li>
<li><a class="reference internal" href="#Accessing-tracker-attributes">Accessing tracker attributes</a></li>
<li><a class="reference internal" href="#Variable-selection-and-geographic-clipping">Variable selection and geographic clipping</a></li>
<li><a class="reference internal" href="#Importing-a-tracker-in-xarray">Importing a tracker in xarray</a></li>
<li><a class="reference internal" href="#Deleting-an-object">Deleting an object</a></li>
<li><a class="reference internal" href="#Viewing-a-tracker-using-ncview">Viewing a tracker using ncview</a></li>
<li><a class="reference internal" href="#Statistical-operations">Statistical operations</a></li>
<li><a class="reference internal" href="#Time-averaging">Time averaging</a></li>
<li><a class="reference internal" href="#Spatial-statistics">Spatial statistics</a></li>
</ul>
</li>
</ul>

  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/.ipynb_checkpoints/basic_usage-checkpoint.ipynb.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="nav-item nav-item-0"><a href="../index.html">nchack 0.1 documentation</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2019, Robert Wilson.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 2.2.0.
    </div>
  </body>
</html>